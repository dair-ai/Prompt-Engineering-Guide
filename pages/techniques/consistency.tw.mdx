# 自我一致性

import { CoursePromo, CoursesSection, CourseCard } from '../../components/CourseCard'

或許在提示詞工程裡更進階的技巧之一就是自我一致性。由 [Wang 等人 (2022)](https://arxiv.org/abs/2203.11171) 所提出，自我一致性的目的是「用以取代在連鎖思考提示詞（chain-of-thought prompting）中使用的單純貪婪解碼」。其主要觀念是透過少量樣本的 CoT，取樣多個不同的推理途徑，並使用產生的答案來選擇最一致的回應。這樣做可以提升涉及算數和常識推理的 CoT 提示詞的效能。

以下是算數推理的一個範例：

*提示詞：*
```
當我 6 歲的時候，我妹妹只有我的一半年齡。現在我已經 70 歲了，那我妹妹多大？
```

*輸出：*
```
35
```

輸出是錯的！我們可以如何透過自我一致性來改進這個問題呢？我們來試試看。我們會使用 Wang 等人 2022 年的論文（表 17）中的少量樣本：

*提示詞：*
```
Q: 林子裡有 15 棵樹。工人今天會在林子裡種樹。他們種完後，會有 21 棵樹。工人今天種了多少棵樹？
A: 一開始有 15 棵樹。之後有 21 棵樹。差距必然是他們種的樹的數量。
所以，他們一定種了 21 - 15 = 6 棵樹。答案是 6。

Q：停車場有 3 輛車，又來了 2 輛車，停車場現在有多少輛車？
A：停車場原本就有 3 輛車。再來了 2 輛。現在有 3 + 2 = 5 輛車。答案是 5。

Q：Leah 有 32 顆巧克力，她的姊姊有 42 顆。如果他們吃了 35 顆，他們總共還剩下多少顆？
A：Leah 有 32 顆巧克力，她的姊姊有 42 顆。這意味著原本有 32 + 42 = 74 顆巧克力。吃掉了 35 顆後，他們還剩下 74 - 35 = 39 顆巧克力。答案是 39。

Q：Jason 有 20 顆棒棒糖，他給了 Denny 一些棒棒糖，現在 Jason 只剩下 12 顆棒棒糖。Jason 給了 Denny 多少顆棒棒糖？
A：Jason 原本有 20 顆棒棒糖。因為他現在只剩下 12 顆，所以他必定是把其餘的給了 Denny。給了 Denny 的棒棒糖數量應該是 20 - 12 = 8 顆棒棒糖。答案是 8。

Q：Shawn 有五個玩具，聖誕節時，他分別從他的媽媽和爸爸那裡得到了兩個玩具，他現在總共有多少個玩具？
A：他原本有 5 個玩具，從媽媽那裡得到了 2 個，所以得到後他有 5 + 2 = 7 個玩具。再從爸爸那裡得到了 2 個，總數變為 7 + 2 = 9 個玩具。答案是 9。

Q：伺服器房內原有 9 臺電腦，從週一至週四，每天都增加了 5 臺電腦，現在伺服器房內有多少臺電腦？
A：從週一到週四有 4 天，每天都新增了 5 臺電腦。這表示總共新增了 4 * 5 = 20 臺電腦。最初有 9 臺，所以現在總共有 9 + 20 = 29 臺電腦。答案是 29。

Q：Michael 原有 58 顆高爾夫球，週二他失去了 23 顆，週三他又失去了 2 顆，週三結束後他還剩下多少顆高爾夫球？
A：Michael 起初有 58 顆球。週二他失去了 23 顆，所以那時他只剩下 58 - 23 = 35 顆。週三他再失去 2 顆，所以現在他剩下 35 - 2 = 33 顆。答案是 33。

Q：Olivia 有 $23，她買了五個貝果，每個 $3，她還剩下多少錢？
A：她買了 5 個貝果，每個 $3，總共花了 5 * 3 = $15。她原有 $23，所以現在她剩下 23 - 15 = $8。答案是 $8。

Q：當我 6 歲時，我的妹妹是我的一半年齡。現在我 70 歲了，我的妹妹幾歲？
A：
```

*輸出 1：*
```
當我 6 歲的時候，我妹妹只有我的一半年齡，也就是 3 歲。現在我已經 70 歲了，所以她應該是 70 - 3 = 67 歲。答案是 67。
```

*輸出 2：*
```
敘述者 6 歲的時候，他妹妹是他年齡的一半，也就是 3 歲。現在敘述者 70 歲了，他妹妹應該是 70 - 3 = 67 歲。答案是 67。
```

*輸出 3：*
```
當我 6 歲的時候，我妹妹只有我的一半年齡，也就是 3 歲。現在我已經 70 歲了，所以她應該是 70/2 = 35 歲。答案是 35。
```

計算最終答案需要幾個步驟（詳細內容請參考論文），但為了簡單起見，我們可以看到已經有一個多數答案浮現，因此這基本上會變成最終的答案。

<CoursesSection title="相關學習">
  <CourseCard
    tag="課程"
    tagColor="blue"
    title="Prompt Engineering for LLMs"
    description="掌握 self-consistency、chain-of-thought 與進階推理技巧，處理複雜任務。"
    href="https://dair-ai.thinkific.com/courses/introduction-prompt-engineering"
    level="入門"
    duration="2 小時"
  />
  <CourseCard
    tag="課程"
    tagColor="purple"
    title="Building Effective AI Agents"
    description="學會打造高效的 AI Agents，涵蓋函式呼叫、工具整合與代理系統除錯。"
    href="https://dair-ai.thinkific.com/courses/agents-with-n8n"
    level="中階"
    duration="5 小時"
  />
</CoursesSection>

<CoursePromo
  title="探索所有課程"
  description="探索我們完整的 AI 與提示詞工程課程目錄，從入門到進階都涵蓋。"
  href="https://dair-ai.thinkific.com/"
  buttonText="瀏覽學院"
  promoCode="PROMPTING20"
/>
